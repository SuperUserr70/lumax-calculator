<!DOCTYPE html>
<html lang="te">
<head>
<meta charset="UTF-8">

<!-- üîí ZOOM LOCK (IMPORTANT) -->
<meta name="viewport"
      content="width=device-width,
               initial-scale=1,
               maximum-scale=1,
               user-scalable=no">

<title>Lumax Enterprises</title>

<!-- PWA / Install -->
<link rel="manifest" href="manifest.json">
<link rel="icon" href="icon.png">
<link rel="apple-touch-icon" href="icon.png">
<meta name="theme-color" content="#0f766e">

<style>
:root{
  --bg:#f1f5f9;
  --card:#ffffff;
  --primary:#0f766e;
  --secondary:#1e293b;
  --danger:#b91c1c;
}

body{
  margin:0;
  font-family: system-ui, Arial;
  background:var(--bg);
}

header{
  background:linear-gradient(135deg,#0f766e,#0891b2);
  color:white;
  padding:16px;
  text-align:center;
  font-size:22px;
  font-weight:700;
  user-select:none;
}

.hidden{ display:none; }

.grid{
  display:grid;
  grid-template-columns:repeat(2,1fr);
  gap:14px;
  padding:14px;
}

.item{
  background:var(--card);
  border-radius:16px;
  padding:20px 10px;
  text-align:center;
  box-shadow:0 6px 14px rgba(0,0,0,.08);
  cursor:pointer;
}

.item:active{
  transform:scale(0.96);
  background:#e5f3f2;
}

.item-name{ font-size:30px; font-weight:800; }
.price{ font-size:20px; color:#555; }
.qty{ font-size:24px; font-weight:800; color:var(--danger); }

footer{
  position:sticky;
  bottom:0;
  background:#020617;
  color:white;
  padding:14px;
  text-align:center;
}

.btn{
  margin:6px;
  background:var(--danger);
  border:none;
  border-radius:10px;
  padding:10px 18px;
  font-size:16px;
  color:white;
}

.btn.secondary{ background:#475569; }

.admin-box{ padding:16px; }

.section{
  background:white;
  border-radius:12px;
  padding:12px;
  margin-bottom:14px;
}

pre{
  white-space:pre-line;
  font-size:15px;
}
</style>
</head>

<body>

<header id="appHeader">Lumax Enterprises</header>

<!-- ================= CALCULATOR ================= -->
<div id="calculator">

  <div class="grid">

    <div class="item" onclick="add('oneL',120)">
      <div class="item-name">1 ‡∞≤‡±Ä‡∞ü‡∞∞‡±ç</div>
      <div class="price">‚Çπ120</div>
      <div class="qty" id="oneL">0</div>
    </div>

    <div class="item" onclick="add('halfL',160)">
      <div class="item-name">‡∞π‡∞æ‡∞´‡±ç ‡∞≤‡±Ä‡∞ü‡∞∞‡±ç</div>
      <div class="price">‚Çπ160</div>
      <div class="qty" id="halfL">0</div>
    </div>

    <div class="item" onclick="add('twoL',180)">
      <div class="item-name">2 ‡∞≤‡±Ä‡∞ü‡∞∞‡±ç</div>
      <div class="price">‚Çπ180</div>
      <div class="qty" id="twoL">0</div>
    </div>

    <div class="item" onclick="add('badam',530)">
      <div class="item-name">‡∞¨‡∞æ‡∞¶‡∞Ç</div>
      <div class="price">‚Çπ530</div>
      <div class="qty" id="badam">0</div>
    </div>

    <div class="item" onclick="add('campa',230)">
      <div class="item-name">‡∞ï‡±ç‡∞Ø‡∞æ‡∞Ç‡∞™‡∞æ</div>
      <div class="price">‚Çπ230</div>
      <div class="qty" id="campa">0</div>
    </div>

  </div>

  <footer>
    <h3>‡∞Æ‡±ä‡∞§‡±ç‡∞§‡∞Ç ‚Çπ<span id="total">0</span></h3>
    <button class="btn" onclick="resetAll()">‡∞∞‡∞ø‡∞∏‡±Ü‡∞ü‡±ç</button>
	<div class="credit">Designed by LumaTech</div>
  </footer>

</div>

<!-- ================= ADMIN ================= -->
<div id="adminPanel" class="hidden admin-box">

  <div class="section">
    <h3>üìÖ Daily Totals</h3>
    <pre id="dailyTotals"></pre>
  </div>

  <div class="section">
    <h3>üßæ Receipt</h3>
    <pre id="receiptBox"></pre>
  </div>

  <button class="btn" onclick="sendSummary()">Send</button>
  <button class="btn" onclick="downloadCSV()">CSV</button>
  <button class="btn" onclick="window.print()">Print</button>
  <button class="btn secondary" onclick="clearSales()">Clear Sales</button>
  <button class="btn" onclick="exitAdmin()">Exit</button>

</div>

<script>
/* ================= CONFIG ================= */
const ADMIN_PIN = "1234";
let adminLogoutTimer = null;

/* ================= DATA ================= */
let total=0, qty={};

const ITEMS={
  oneL:"1 ‡∞≤‡±Ä‡∞ü‡∞∞‡±ç",
  halfL:"‡∞π‡∞æ‡∞´‡±ç ‡∞≤‡±Ä‡∞ü‡∞∞‡±ç",
  twoL:"2 ‡∞≤‡±Ä‡∞ü‡∞∞‡±ç",
  badam:"‡∞¨‡∞æ‡∞¶‡∞Ç",
  campa:"‡∞ï‡±ç‡∞Ø‡∞æ‡∞Ç‡∞™‡∞æ"
};

/* ================= SELL ================= */
function add(id,price){
  qty[id]=(qty[id]||0)+1;
  document.getElementById(id).innerText=qty[id];
  total+=price;
  document.getElementById("total").innerText=total;
}

function resetAll(){
  if(total>0) saveSale();
  total=0; qty={};
  document.getElementById("total").innerText=0;
  document.querySelectorAll(".qty").forEach(q=>q.innerText=0);
}

/* ================= STORAGE ================= */
function saveSale(){
  const sales=JSON.parse(localStorage.getItem("sales")||"[]");
  let items={};
  for(let id in qty) items[ITEMS[id]]=qty[id];
  sales.push({date:new Date().toISOString(),items,total});
  localStorage.setItem("sales",JSON.stringify(sales));
}

/* ================= ADMIN ACCESS ================= */
let pressTimer;
const header=document.getElementById("appHeader");

header.addEventListener("touchstart",()=>pressTimer=setTimeout(askPin,3000));
header.addEventListener("touchend",()=>clearTimeout(pressTimer));
header.addEventListener("dblclick",askPin);

function askPin(){
  const pin=prompt("Enter Admin PIN");
  if(pin===ADMIN_PIN) enterAdmin();
  else alert("Wrong PIN");
}

function enterAdmin(){
  document.getElementById("calculator").classList.add("hidden");
  document.getElementById("adminPanel").classList.remove("hidden");
  buildAdminData();

  /* ‚è± AUTO LOGOUT (5 MINUTES) */
  clearTimeout(adminLogoutTimer);
  adminLogoutTimer=setTimeout(exitAdmin,5*60*1000);
}

function exitAdmin(){
  clearTimeout(adminLogoutTimer);
  document.getElementById("adminPanel").classList.add("hidden");
  document.getElementById("calculator").classList.remove("hidden");
}

/* ================= ADMIN DATA ================= */
function buildAdminData(){
  const sales=JSON.parse(localStorage.getItem("sales")||"[]");
  buildDailyTotals(sales);
  buildReceipt(sales);
}

function buildDailyTotals(sales){
  let map={};
  sales.forEach(s=>{
    const d=s.date.split("T")[0];
    map[d]=(map[d]||0)+s.total;
  });
  let txt="";
  for(let d in map) txt+=`${d} ‚Üí ‚Çπ${map[d]}\n`;
  document.getElementById("dailyTotals").innerText=txt||"No data";
}

function buildReceipt(sales){
  let txt="LumaTech Store\n------------------\n";
  sales.forEach((s,i)=>{
    txt+=`#${i+1} ${new Date(s.date).toLocaleString()}\n`;
    for(let k in s.items) txt+=` ${k} x ${s.items[k]}\n`;
    txt+=` Total: ‚Çπ${s.total}\n\n`;
  });
  document.getElementById("receiptBox").innerText=txt||"No data";
}

/* ================= EXPORT ================= */
function sendSummary(){
  window.open(`https://wa.me/?text=${encodeURIComponent(
    document.getElementById("receiptBox").innerText
  )}`);
}

function downloadCSV(){
  const sales=JSON.parse(localStorage.getItem("sales")||"[]");
  let csv="Date,Item,Qty,Total\n";
  sales.forEach(s=>{
    for(let k in s.items){
      csv+=`${s.date},${k},${s.items[k]},${s.total}\n`;
    }
  });
  const blob=new Blob([csv],{type:"text/csv"});
  const a=document.createElement("a");
  a.href=URL.createObjectURL(blob);
  a.download="sales.csv";
  a.click();
}

/* ================= CLEAR SALES (SAFE) ================= */
function clearSales(){
  if(!confirm("Delete ALL sales permanently?")) return;
  const pin=prompt("Re-enter Admin PIN");
  if(pin!==ADMIN_PIN){
    alert("Wrong PIN. Action cancelled.");
    return;
  }
  localStorage.removeItem("sales");
  document.getElementById("dailyTotals").innerText="No data";
  document.getElementById("receiptBox").innerText="No data";
  alert("Sales cleared successfully.");
}
</script>

</body>
</html>
